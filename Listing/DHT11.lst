C51 COMPILER V9.54   DHT11                                                                 12/29/2019 01:08:44 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE DHT11
OBJECT MODULE PLACED IN ..\Output\DHT11.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE DHT11\DHT11.C LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(.\GSM;.\Ultrasonic;.
                    -\XY-V17B;.\DS18B20;.\uart;.\delay;.\LED;.\BH1750;.\DHT11) DEBUG OBJECTEXTEND PRINT(..\Listing\DHT11.lst) OBJECT(..\Outpu
                    -t\DHT11.obj)

line level    source

   1          #include "dht11.h"
   2          #include "delay.h"
   3          
   4          sbit io=P0^2;//dht11data端接单片机的P1^0口// 
   5          
   6          uchar data_byte; 
   7          uchar RH,RL,TH,TL; 
   8          
   9          //**************************dht11测试某块*************************************// 
  10          
  11          void start()//开始信号 
  12          { 
  13   1              io=1; 
  14   1              delay24us(); 
  15   1              io=0; 
  16   1              delay5ms();// 主机把总线拉低必须大于18ms１ＶDHT11能检测到起始信号 
  17   1              delay5ms();
  18   1              delay5ms();
  19   1              io=1;    //发送开始信号结束后＠高电平延时20-40us 
  20   1              delay24us();//以下三个延时函数差不多为24us７合要求 
  21   1      } 
  22          
  23           
  24          
  25          uchar receive_byte()//接收一个字节// 
  26          { 
  27   1              uchar i,temp; 
  28   1              for(i=0;i<8;i++)//接收8bit的数据 
  29   1              { 
  30   2                      while(!io);//等待50us的低电平开始信号结束 
  31   2                      delay24us();//开始信号结束之后Ｑ邮26us-28us∫韵氯个延时函数 
  32   2                      temp=0;//时间为26us-28us１硎窘邮盏奈数据'0' 
  33   2                      if(io==1) 
  34   2                              temp=1; //如果26us-28us之后；刮高电平Ｔ虮硎窘邮盏氖据为'1' 
  35   2                      while(io);//等待数据信号高电平'0'为26us-28us'1'为70us 
  36   2                      data_byte<<=1;//接收的数据为高位在前∮乙篇 
  37   2                      data_byte|=temp; 
  38   2              } 
  39   1              return data_byte; 
  40   1      } 
  41          unsigned int  receive()//接收数据// 
  42          { 
  43   1              unsigned int temperiture=0;
  44   1              uchar T_H,T_L,R_H,R_L,check,num_check,i; 
  45   1              start();//开始信号// 
  46   1              io=1;   //主机设为输入Ｅ卸洗踊DHT11⑾煊π藕 
  47   1              if(!io)//判断从机是否有低电平响应信号// 
  48   1              {  
  49   2                      while(!io);//判断从机发出 80us 的低电平响应信号是否结束// 
  50   2                      while(io);//判断从机发出 80us 的高电平是否结束Ｈ缃崾则主机进入数据接收状态 
  51   2                      R_H=receive_byte();//湿度高位 
  52   2                      R_L=receive_byte();//湿度低位 
  53   2                      T_H=receive_byte();//温度高位 
C51 COMPILER V9.54   DHT11                                                                 12/29/2019 01:08:44 PAGE 2   

  54   2                      T_L=receive_byte();//温度低位 
  55   2                      check=receive_byte();//校验位 
  56   2                      io=0; //当最后一bit数据接完毕后４踊拉低电平50us// 
  57   2                      for(i=0;i<2;i++)//差不多50us的延时 
  58   2                              delay24us(); 
  59   2                      io=1;//总线由上拉电阻拉高＝入空闲状态 
  60   2                      num_check=R_H+R_L+T_H+T_L; 
  61   2                      if(num_check==check)//判断读到的四个数据之和是否与校验位相同 
  62   2                      { 
  63   3                              RH=R_H; 
  64   3                              RL=R_L; 
  65   3                              TH=T_H; 
  66   3                              TL=T_L; 
  67   3                              check=num_check; 
  68   3                      } 
  69   2                      temperiture = T_H;
  70   2                      return temperiture;
  71   2              } 
  72   1      } 
*** WARNING C291 IN LINE 72 OF DHT11\DHT11.C: not every exit path returns a value


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    241    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      5      10
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
